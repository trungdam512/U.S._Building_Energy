```{r libraries, echo = FALSE, message = FALSE}
# load libraries and any relevant data here
library(tidyverse)

recs <- readRDS("../data/recs_2015_cleaned.RDS")
```

## Summary and missing data

```{r}
summary(recs)
```
No variables are missing! Note that natural gas, propane, and other fuels all have a 1st quartile of 0, and propane and other fuels have up to a 3rd quartile of 0. This indicates that many of the houses included in this dataset do not use propane or fuels categorized as "other", which is not surprising based on knowledge of fuel types. It also indicates that a relatively significant amount of houses do not use natural gas.

Also note that some of these variables represent levels, and thus their summary statistics may not have an interpretable meaning.


## Preliminary visualizations

Metropolitan or Micropolitan Statistical Area by Region

```{r}
recs %>%
  mutate(
    region_name = case_when(
      REGIONC == 1 ~ "Northeast",
      REGIONC == 2 ~ "Midwest",
      REGIONC == 3 ~ "South",
      REGIONC == 4 ~ "West"
    )
  ) %>% 
  ggplot(aes(x = METROMICRO)) +
    geom_bar(aes(fill = region_name), position = "dodge") +
    theme_classic()
```


Histogram of housing type

```{r}
recs %>% 
  mutate(
    housing_type = case_when(
      TYPEHUQ == 1 ~ "Mobile home",
      TYPEHUQ == 2 ~ "Single family detached",
      TYPEHUQ == 3 ~ "Single family attached",
      TYPEHUQ == 4 ~ "Apt small building",
      TYPEHUQ == 5 ~ "Apt large building"
    )
  ) %>% 
  ggplot(aes(x = housing_type)) +
  geom_bar() +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1)) 
```


Histogram of age range (facet by region?)

```{r}
recs$yearmade <- factor(recs$yearmade, levels = c(
  "Before 1950", "1950 to 1959", "1960 to 1969", "1970 to 1979", "1980 to 1989", "1990 to 1999", "2000 to 2009", "2010 to 2015"
))

ggplot(recs, aes(x = yearmade)) +
  geom_bar() +
  theme_classic()
```


comparison of el, ng, lp, fo

```{r}
ggplot(recs, aes(x = BTUEL, y = BTUNG)) +
  geom_point() +
  theme_classic()
```


Electricity use by region

```{r}
recs %>%
  mutate(
    region_name = case_when(
      REGIONC == 1 ~ "Northeast",
      REGIONC == 2 ~ "Midwest",
      REGIONC == 3 ~ "South",
      REGIONC == 4 ~ "West"
    )
  ) %>% 
ggplot(aes(y = BTUEL, x = region_name)) +
  geom_boxplot() +
  theme_classic()
```
It's interesting that the South has a noticeably higher IQR than the other regions- maybe due to use of air conditioning?


Boxplot of electricity use by year the building was built

```{r}
recs$yearmade <- factor(recs$yearmade, levels = c(
  "Before 1950", "1950 to 1959", "1960 to 1969", "1970 to 1979", "1980 to 1989", "1990 to 1999", "2000 to 2009", "2010 to 2015"
)) 
ggplot(recs, aes(x = yearmade, y = BTUEL)) +
  geom_boxplot() +
  theme_classic()
```
Electricity use seems to increase in as buildings get newer; it makes sense in that newer buildings would likely include more features that use electricity.


Barplot of total energy usage by year range and region of building

```{r}
recs$yearmade <- factor(recs$yearmade, levels = c(
  "Before 1950", "1950 to 1959", "1960 to 1969", "1970 to 1979", "1980 to 1989", "1990 to 1999", "2000 to 2009", "2010 to 2015"
))

recs %>% 
  group_by(yearmade, region_name) %>% 
  summarise(agg_btu = sum(TOTALBTU)) %>% 
ggplot(aes(y = agg_btu, x = yearmade, fill = region_name)) +
  geom_bar(stat = 'identity') +
   theme_classic() +
  theme(axis.text.x = element_text(angle = 35, hjust = 1, vjust = 1)) 
```
Is  2010-2015 category so low because data was only collected through 2010? Is there a less misleading way to represent that?



Plan for Plan for Milestone 3:

-Meet to revise/specify broad questions

-Load in and clean additional datasets

  -Data about changes in technology and policy in our time frame
  
-Create visualizations to address our research questions, do some serious wrangling and analysis


```{r}
 sessionInfo()
```

